%{

#include <stack>
#include <list>
#include <cstring>
#include <cstdio>
#include <cstdlib>
using namespace std;
#include "commun.h"

extern char xmltext[];

int xmllex(void);  

void xmlerror(const char * msg)
{
   fprintf(stderr,"%s\n",msg);
}

%}

%union {
   char * s;
}

%token EGAL SLASH SUP SUPSPECIAL DOCTYPE COLON INFSPECIAL INF CDATABEGIN
%token <s> VALEUR DONNEES COMMENT NOM CDATAEND

%%

document
 : prolog element miscs
 ;

element
 : INF NOM attributes SUP
   content
   INF SLASH NOM SUP
 | INF NOM attributes SLASH SUP               
 ;

content
 : content element
 | content cdsect
 | content pi
 | content COMMENT          
 | /* vide */              
 ;


attributes
 : attributes attribute
 | /*vide*/
 ;

attribute
 : NOM EGAL VALEUR
 ;

doctypedecl 
 : DOCTYPE NOM NOM SUP
 | DOCTYPE NOM SUP
 ;

prolog
 : xmldecl miscs doctypedecl miscs
// | miscs doctypedecl miscs
 | xmldecl miscs
// | miscs
 ; 

xmldecl
 : INFSPECIAL NOM versioninfo attributes SUPSPECIAL
// | /*vide*/
 ;

miscs
 : miscs misc
 | /*vide*/
 ;

misc
 : COMMENT
 | pi
 ;

pi
 : INFSPECIAL NOM attributes SUPSPECIAL
 ;

versioninfo
 : DONNEES EGAL DONNEES
 ;

cdsect
 : CDATABEGIN DONNEES CDATAEND
 ;
